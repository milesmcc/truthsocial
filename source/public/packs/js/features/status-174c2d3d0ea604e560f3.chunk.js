(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{855:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return ee}));var n,o,s,i,l,c,r,d=a(0),u=a(5),p=a(4),h=a.n(p),f=a(1),g=a.n(f),m=a(9),b=a(2),k=a.n(b),v=a(12),M=a.n(v),C=a(16),y=a.n(C),O=a(58),j=a(30),_=a(808),I=a(323),w=a(19),D=a(105),R=a(3),x=a(7),U=Object(R.f)({delete:{id:"status.delete",defaultMessage:"Delete"},redraft:{id:"status.redraft",defaultMessage:"Delete & re-draft"},direct:{id:"status.direct",defaultMessage:"Direct message @{name}"},mention:{id:"status.mention",defaultMessage:"Mention @{name}"},reply:{id:"status.reply",defaultMessage:"Reply"},reblog:{id:"status.reblog",defaultMessage:"Boost"},reblog_private:{id:"status.reblog_private",defaultMessage:"Boost with original visibility"},cancel_reblog_private:{id:"status.cancel_reblog_private",defaultMessage:"Unboost"},cannot_reblog:{id:"status.cannot_reblog",defaultMessage:"This post cannot be boosted"},favourite:{id:"status.favourite",defaultMessage:"Favourite"},bookmark:{id:"status.bookmark",defaultMessage:"Bookmark"},more:{id:"status.more",defaultMessage:"More"},mute:{id:"status.mute",defaultMessage:"Mute @{name}"},muteConversation:{id:"status.mute_conversation",defaultMessage:"Mute Conversation"},unmuteConversation:{id:"status.unmute_conversation",defaultMessage:"Unmute conversation"},block:{id:"status.block",defaultMessage:"Block @{name}"},report:{id:"status.report",defaultMessage:"Report @{name}"},share:{id:"status.share",defaultMessage:"Share"},pin:{id:"status.pin",defaultMessage:"Pin on profile"},unpin:{id:"status.unpin",defaultMessage:"Unpin from profile"},embed:{id:"status.embed",defaultMessage:"Embed"},admin_account:{id:"status.admin_account",defaultMessage:"Open moderation interface for @{name}"},admin_status:{id:"status.admin_status",defaultMessage:"Open this status in the moderation interface"},copy:{id:"status.copy",defaultMessage:"Copy link to status"},blockDomain:{id:"account.block_domain",defaultMessage:"Block domain {domain}"},unblockDomain:{id:"account.unblock_domain",defaultMessage:"Unblock domain {domain}"},unmute:{id:"account.unmute",defaultMessage:"Unmute @{name}"},unblock:{id:"account.unblock",defaultMessage:"Unblock @{name}"}}),H=Object(m.connect)((function(e,t){var a=t.status;return{relationship:e.getIn(["relationships",a.getIn(["account","id"])])}}))(n=Object(R.g)((s=o=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).handleReplyClick=function(){t.props.onReply(t.props.status)},t.handleReblogClick=function(e){t.props.onReblog(t.props.status,e)},t.handleFavouriteClick=function(){t.props.onFavourite(t.props.status)},t.handleBookmarkClick=function(e){t.props.onBookmark(t.props.status,e)},t.handleDeleteClick=function(){t.props.onDelete(t.props.status,t.context.router.history)},t.handleRedraftClick=function(){t.props.onDelete(t.props.status,t.context.router.history,!0)},t.handleDirectClick=function(){t.props.onDirect(t.props.status.get("account"),t.context.router.history)},t.handleMentionClick=function(){t.props.onMention(t.props.status.get("account"),t.context.router.history)},t.handleMuteClick=function(){var e=t.props,a=e.status,n=e.relationship,o=e.onMute,s=e.onUnmute,i=a.get("account");n&&n.get("muting")?s(i):o(i)},t.handleBlockClick=function(){var e=t.props,a=e.status,n=e.relationship,o=e.onBlock,s=e.onUnblock,i=a.get("account");n&&n.get("blocking")?s(i):o(a)},t.handleBlockDomain=function(){var e=t.props,a=e.status;(0,e.onBlockDomain)(a.get("account").get("acct").split("@")[1])},t.handleUnblockDomain=function(){var e=t.props,a=e.status;(0,e.onUnblockDomain)(a.get("account").get("acct").split("@")[1])},t.handleConversationMuteClick=function(){t.props.onMuteConversation(t.props.status)},t.handleReport=function(){t.props.onReport(t.props.status)},t.handlePinClick=function(){t.props.onPin(t.props.status)},t.handleShare=function(){navigator.share({text:t.props.status.get("search_index"),url:t.props.status.get("url")})},t.handleEmbed=function(){t.props.onEmbed(t.props.status)},t.handleCopy=function(){var e=t.props.status.get("url"),a=document.createElement("textarea");a.textContent=e,a.style.position="fixed",document.body.appendChild(a);try{a.select(),document.execCommand("copy")}catch(e){}finally{document.body.removeChild(a)}},t}return Object(u.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.status,a=e.relationship,n=e.intl,o=["public","unlisted"].includes(t.get("visibility")),s=t.get("muted"),i=t.get("account"),l=t.getIn(["account","id"])===x.m,c=[];if(o&&(c.push({text:n.formatMessage(U.copy),action:this.handleCopy}),c.push({text:n.formatMessage(U.embed),action:this.handleEmbed}),c.push(null)),l)o&&(c.push({text:n.formatMessage(t.get("pinned")?U.unpin:U.pin),action:this.handlePinClick}),c.push(null)),c.push({text:n.formatMessage(s?U.unmuteConversation:U.muteConversation),action:this.handleConversationMuteClick}),c.push(null),c.push({text:n.formatMessage(U.delete),action:this.handleDeleteClick}),c.push({text:n.formatMessage(U.redraft),action:this.handleRedraftClick});else{if(c.push({text:n.formatMessage(U.mention,{name:t.getIn(["account","username"])}),action:this.handleMentionClick}),c.push({text:n.formatMessage(U.direct,{name:t.getIn(["account","username"])}),action:this.handleDirectClick}),c.push(null),a&&a.get("muting")?c.push({text:n.formatMessage(U.unmute,{name:i.get("username")}),action:this.handleMuteClick}):c.push({text:n.formatMessage(U.mute,{name:i.get("username")}),action:this.handleMuteClick}),a&&a.get("blocking")?c.push({text:n.formatMessage(U.unblock,{name:i.get("username")}),action:this.handleBlockClick}):c.push({text:n.formatMessage(U.block,{name:i.get("username")}),action:this.handleBlockClick}),c.push({text:n.formatMessage(U.report,{name:t.getIn(["account","username"])}),action:this.handleReport}),i.get("acct")!==i.get("username")){var r=i.get("acct").split("@")[1];c.push(null),a&&a.get("domain_blocking")?c.push({text:n.formatMessage(U.unblockDomain,{domain:r}),action:this.handleUnblockDomain}):c.push({text:n.formatMessage(U.blockDomain,{domain:r}),action:this.handleBlockDomain})}x.k&&(c.push(null),c.push({text:n.formatMessage(U.admin_account,{name:t.getIn(["account","username"])}),href:"/admin/accounts/"+t.getIn(["account","id"])}),c.push({text:n.formatMessage(U.admin_status),href:"/admin/accounts/"+t.getIn(["account","id"])+"/statuses/"+t.get("id")}))}var u,p="share"in navigator&&o&&Object(d.a)("div",{className:"detailed-status__button"},void 0,Object(d.a)(w.a,{svg:"share",title:n.formatMessage(U.share),icon:"share-alt",onClick:this.handleShare}));u=null===t.get("in_reply_to_id",null)?"reply":"reply-all";var h,f=t.getIn(["account","id"])===x.m&&"private"===t.get("visibility");return h=t.get("reblogged")?n.formatMessage(U.cancel_reblog_private):o?n.formatMessage(U.reblog):f?n.formatMessage(U.reblog_private):n.formatMessage(U.cannot_reblog),Object(d.a)("div",{className:"detailed-status__action-bar"},void 0,Object(d.a)("div",{className:"detailed-status__button"},void 0,Object(d.a)(w.a,{svg:"reply",title:n.formatMessage(U.reply),icon:t.get("in_reply_to_account_id")===t.getIn(["account","id"])?"reply":u,onClick:this.handleReplyClick})),Object(d.a)("div",{className:"detailed-status__button"},void 0,Object(d.a)(w.a,{svg:"retruth",className:M()({reblogPrivate:f}),disabled:!o&&!f,active:t.get("reblogged"),title:h,icon:"retweet",onClick:this.handleReblogClick})),Object(d.a)("div",{className:"detailed-status__button"},void 0,Object(d.a)(w.a,{svg:"fire",className:"star-icon",animate:!0,active:t.get("favourited"),title:n.formatMessage(U.favourite),icon:"star",onClick:this.handleFavouriteClick})),p,Object(d.a)("div",{className:"detailed-status__action-bar-dropdown"},void 0,Object(d.a)(D.a,{size:18,icon:"ellipsis-h",status:t,items:c,direction:"left",title:n.formatMessage(U.more)})))},t}(g.a.PureComponent),o.contextTypes={router:k.a.object},n=s))||n)||n,B=a(201),T=a(22),S=a(10),A=a(11),F=a(39),P=a(38),V=a(54),E=a(66),N=a(53),z=a(35),q=a(135),J=a(207),L=a(202),K=a(131),W=a(21),Y=a(17),X=a(104),G=a(70),Q=a(198),Z=a(13),$=Object(R.f)({deleteConfirm:{id:"confirmations.delete.confirm",defaultMessage:"Delete"},deleteMessage:{id:"confirmations.delete.message",defaultMessage:"Are you sure you want to delete this status?"},redraftConfirm:{id:"confirmations.redraft.confirm",defaultMessage:"Delete & redraft"},redraftMessage:{id:"confirmations.redraft.message",defaultMessage:"Are you sure you want to delete this status and re-draft it? Favourites and boosts will be lost, and replies to the original post will be orphaned."},revealAll:{id:"status.show_more_all",defaultMessage:"Show more for all"},hideAll:{id:"status.show_less_all",defaultMessage:"Show less for all"},detailedStatus:{id:"status.detailed_status",defaultMessage:"Detailed conversation view"},replyConfirm:{id:"confirmations.reply.confirm",defaultMessage:"Reply"},replyMessage:{id:"confirmations.reply.message",defaultMessage:"Replying now will overwrite the message you are currently composing. Are you sure you want to proceed?"},blockDomainConfirm:{id:"confirmations.domain_block.confirm",defaultMessage:"Hide entire domain"}}),ee=(i=Object(m.connect)((function(){var e=Object(z.g)(),t=Object(z.f)(),a=Object(O.a)([function(e,t){return t.id},function(e){return e.getIn(["contexts","inReplyTos"])}],(function(e,t){var a=h.a.List();return a=a.withMutations((function(a){for(var n=e;n;)a.unshift(n),n=t.get(n)}))})),n=Object(O.a)([function(e,t){return t.id},function(e){return e.getIn(["contexts","replies"])},function(e){return e.get("statuses")}],(function(e,t,a){for(var n=[],o=[e];o.length>0;){var s=o.shift(),i=t.get(s);e!==s&&n.push(s),i&&i.reverse().forEach((function(e){o.unshift(e)}))}var l=n.findIndex((function(e){return a.get(e).get("in_reply_to_account_id")!==a.get(e).get("account")}));return-1!==l&&n.forEach((function(e,t){t>l&&a.get(e).get("in_reply_to_account_id")===a.get(e).get("account")&&(n.splice(t,1),n.splice(l,0,e),l+=1)})),h.a.List(n)}));return function(o,s){var i=e(o,{id:s.params.statusId}),l=h.a.List(),c=h.a.List();return i&&(l=a(o,{id:i.get("in_reply_to_id")}),c=n(o,{id:i.get("id")})),{status:i,ancestorsIds:l,descendantsIds:c,askReplyConfirmation:0!==o.getIn(["compose","text"]).trim().length,domain:o.getIn(["meta","domain"]),pictureInPicture:t(o,{id:s.params.statusId})}}})),Object(R.g)(l=i((r=c=function(e){function t(){for(var t,a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).state={fullscreen:!1,showMedia:Object(Q.b)(t.props.status),loadedStatusId:void 0},t.handleToggleMediaVisibility=function(){t.setState({showMedia:!t.state.showMedia})},t.handleFavouriteClick=function(e){e.get("favourited")?t.props.dispatch(Object(T.x)(e)):t.props.dispatch(Object(T.r)(e))},t.handlePin=function(e){e.get("pinned")?t.props.dispatch(Object(T.y)(e)):t.props.dispatch(Object(T.u)(e))},t.handleReplyClick=function(e){var a=t.props,n=a.askReplyConfirmation,o=a.dispatch,s=a.intl;o(n?Object(W.d)("CONFIRM",{message:s.formatMessage($.replyMessage),confirm:s.formatMessage($.replyConfirm),onConfirm:function(){return o(Object(S.kb)(e,t.context.router.history))}}):Object(S.kb)(e,t.context.router.history))},t.handleModalReblog=function(e,a){t.props.dispatch(Object(T.v)(e,a))},t.handleReblogClick=function(e,a){e.get("reblogged")?t.props.dispatch(Object(T.z)(e)):a&&a.shiftKey||!x.b?t.handleModalReblog(e):t.props.dispatch(Object(E.d)({status:e,onReblog:t.handleModalReblog}))},t.handleBookmarkClick=function(e){e.get("bookmarked")?t.props.dispatch(Object(T.w)(e)):t.props.dispatch(Object(T.q)(e))},t.handleDeleteClick=function(e,a,n){void 0===n&&(n=!1);var o=t.props,s=o.dispatch,i=o.intl;x.e?s(Object(W.d)("CONFIRM",{message:i.formatMessage(n?$.redraftMessage:$.deleteMessage),confirm:i.formatMessage(n?$.redraftConfirm:$.deleteConfirm),onConfirm:function(){return s(Object(j.h)(e.get("id"),a,n))}})):s(Object(j.h)(e.get("id"),a,n))},t.handleDirectClick=function(e,a){t.props.dispatch(Object(S.bb)(e,a))},t.handleMentionClick=function(e,a){t.props.dispatch(Object(S.gb)(e,a))},t.handleOpenMedia=function(e,a){t.props.dispatch(Object(W.d)("MEDIA",{statusId:t.props.status.get("id"),media:e,index:a}))},t.handleOpenVideo=function(e,a){t.props.dispatch(Object(W.d)("VIDEO",{statusId:t.props.status.get("id"),media:e,options:a}))},t.handleHotkeyOpenMedia=function(e){var a=t.props.status;e.preventDefault(),a.get("media_attachments").size>0&&("video"===a.getIn(["media_attachments",0,"type"])?t.handleOpenVideo(a.getIn(["media_attachments",0]),{startTime:0}):t.handleOpenMedia(a.get("media_attachments"),0))},t.handleMuteClick=function(e){t.props.dispatch(Object(P.m)(e))},t.handleConversationMuteClick=function(e){e.get("muted")?t.props.dispatch(Object(j.n)(e.get("id"))):t.props.dispatch(Object(j.k)(e.get("id")))},t.handleToggleHidden=function(e){e.get("hidden")?t.props.dispatch(Object(j.l)(e.get("id"))):t.props.dispatch(Object(j.j)(e.get("id")))},t.handleToggleAll=function(){var e=t.props,a=e.status,n=e.ancestorsIds,o=e.descendantsIds,s=[a.get("id")].concat(n.toJS(),o.toJS());a.get("hidden")?t.props.dispatch(Object(j.l)(s)):t.props.dispatch(Object(j.j)(s))},t.handleBlockClick=function(e){var a=t.props.dispatch,n=e.get("account");a(Object(V.j)(n))},t.handleReport=function(e){t.props.dispatch(Object(N.k)(e.get("account"),e))},t.handleEmbed=function(e){t.props.dispatch(Object(W.d)("EMBED",{url:e.get("url")}))},t.handleUnmuteClick=function(e){t.props.dispatch(Object(A.X)(e.get("id")))},t.handleUnblockClick=function(e){t.props.dispatch(Object(A.V)(e.get("id")))},t.handleBlockDomainClick=function(e){t.props.dispatch(Object(W.d)("CONFIRM",{message:Object(d.a)(R.b,{id:"confirmations.domain_block.message",defaultMessage:"Are you really, really sure you want to block the entire {domain}? In most cases a few targeted blocks or mutes are sufficient and preferable. You will not see content from that domain in any public timelines or your notifications. Your followers from that domain will be removed.",values:{domain:Object(d.a)("strong",{},void 0,e)}}),confirm:t.props.intl.formatMessage($.blockDomainConfirm),onConfirm:function(){return t.props.dispatch(Object(F.e)(e))}}))},t.handleUnblockDomainClick=function(e){t.props.dispatch(Object(F.h)(e))},t.handleHotkeyMoveUp=function(){t.handleMoveUp(t.props.status.get("id"))},t.handleHotkeyMoveDown=function(){t.handleMoveDown(t.props.status.get("id"))},t.handleHotkeyReply=function(e){e.preventDefault(),t.handleReplyClick(t.props.status)},t.handleHotkeyFavourite=function(){t.handleFavouriteClick(t.props.status)},t.handleHotkeyBoost=function(){t.handleReblogClick(t.props.status)},t.handleHotkeyMention=function(e){e.preventDefault(),t.handleMentionClick(t.props.status.get("account"))},t.handleHotkeyOpenProfile=function(){t.context.router.history.push("/accounts/"+t.props.status.getIn(["account","id"]))},t.handleHotkeyToggleHidden=function(){t.handleToggleHidden(t.props.status)},t.handleHotkeyToggleSensitive=function(){t.handleToggleMediaVisibility()},t.handleMoveUp=function(e){var a=t.props,n=a.status,o=a.ancestorsIds,s=a.descendantsIds;if(e===n.get("id"))t._selectChild(o.size-1,!0);else{var i=o.indexOf(e);-1===i?(i=s.indexOf(e),t._selectChild(o.size+i,!0)):t._selectChild(i-1,!0)}},t.handleMoveDown=function(e){var a=t.props,n=a.status,o=a.ancestorsIds,s=a.descendantsIds;if(e===n.get("id"))t._selectChild(o.size+1,!1);else{var i=o.indexOf(e);-1===i?(i=s.indexOf(e),t._selectChild(o.size+i+2,!1)):t._selectChild(i+1,!1)}},t.setRef=function(e){t.node=e},t.onFullScreenChange=function(){t.setState({fullscreen:Object(G.d)()})},t}Object(u.a)(t,e);var a=t.prototype;return a.componentWillMount=function(){this.props.dispatch(Object(j.i)(this.props.params.statusId))},a.componentDidMount=function(){Object(G.a)(this.onFullScreenChange)},a.componentWillReceiveProps=function(e){e.params.statusId!==this.props.params.statusId&&e.params.statusId&&(this._scrolledIntoView=!1,this.props.dispatch(Object(j.i)(e.params.statusId))),e.status&&e.status.get("id")!==this.state.loadedStatusId&&this.setState({showMedia:Object(Q.b)(e.status),loadedStatusId:e.status.get("id")})},a._selectChild=function(e,t){var a=this.node,n=a.querySelectorAll(".focusable")[e];n&&(t&&a.scrollTop>n.offsetTop?n.scrollIntoView(!0):!t&&a.scrollTop+a.clientHeight<n.offsetTop+n.offsetHeight&&n.scrollIntoView(!1),n.focus())},a.renderChildren=function(e){var t=this;return e.map((function(e){return Object(d.a)(K.a,{id:e,onMoveUp:t.handleMoveUp,onMoveDown:t.handleMoveDown,contextType:"thread"},e)}))},a.componentDidUpdate=function(){if(!this._scrolledIntoView){var e=this.props,t=e.status,a=e.ancestorsIds;if(t&&a&&a.size>0){var n=this.node.querySelectorAll(".focusable")[a.size-1];window.requestAnimationFrame((function(){n.scrollIntoView(!0)})),this._scrolledIntoView=!0}}},a.componentWillUnmount=function(){Object(G.b)(this.onFullScreenChange)},a.render=function(){var e,t,a=this.props,n=a.shouldUpdateScroll,o=a.status,s=a.ancestorsIds,i=a.descendantsIds,l=a.intl,c=a.domain,r=a.multiColumn,u=a.pictureInPicture,p=this.state.fullscreen;if(null===o)return Object(d.a)(B.a,{},void 0,Object(d.a)(J.a,{multiColumn:r}),Object(d.a)(_.a,{}));s&&s.size>0&&(e=Object(d.a)("div",{},void 0,this.renderChildren(s))),i&&i.size>0&&(t=Object(d.a)("div",{},void 0,this.renderChildren(i)));var h={moveUp:this.handleHotkeyMoveUp,moveDown:this.handleHotkeyMoveDown,reply:this.handleHotkeyReply,favourite:this.handleHotkeyFavourite,boost:this.handleHotkeyBoost,mention:this.handleHotkeyMention,openProfile:this.handleHotkeyOpenProfile,toggleHidden:this.handleHotkeyToggleHidden,toggleSensitive:this.handleHotkeyToggleSensitive,openMedia:this.handleHotkeyOpenMedia};return Object(d.a)(B.a,{bindToDocument:!r,label:l.formatMessage($.detailedStatus)},void 0,Object(d.a)(L.a,{showBackButton:!0,multiColumn:r,extraButton:Object(d.a)("button",{className:"column-header__button",title:l.formatMessage(o.get("hidden")?$.revealAll:$.hideAll),"aria-label":l.formatMessage(o.get("hidden")?$.revealAll:$.hideAll),onClick:this.handleToggleAll,"aria-pressed":o.get("hidden")?"false":"true"},void 0,Object(d.a)(Z.a,{id:o.get("hidden")?"eye-slash":"eye"}))}),Object(d.a)(q.a,{scrollKey:"thread",shouldUpdateScroll:n},void 0,g.a.createElement("div",{className:M()("scrollable",{fullscreen:p}),ref:this.setRef},e,Object(d.a)(X.HotKeys,{handlers:h},void 0,Object(d.a)("div",{className:M()("focusable","detailed-status__wrapper"),tabIndex:"0","aria-label":Object(Q.c)(l,o,!1)},void 0,Object(d.a)(I.a,{status:o,onOpenVideo:this.handleOpenVideo,onOpenMedia:this.handleOpenMedia,onToggleHidden:this.handleToggleHidden,domain:c,showMedia:this.state.showMedia,onToggleMediaVisibility:this.handleToggleMediaVisibility,pictureInPicture:u},"details-"+o.get("id")),Object(d.a)(H,{status:o,onReply:this.handleReplyClick,onFavourite:this.handleFavouriteClick,onReblog:this.handleReblogClick,onBookmark:this.handleBookmarkClick,onDelete:this.handleDeleteClick,onDirect:this.handleDirectClick,onMention:this.handleMentionClick,onMute:this.handleMuteClick,onUnmute:this.handleUnmuteClick,onMuteConversation:this.handleConversationMuteClick,onBlock:this.handleBlockClick,onUnblock:this.handleUnblockClick,onBlockDomain:this.handleBlockDomainClick,onUnblockDomain:this.handleUnblockDomainClick,onReport:this.handleReport,onPin:this.handlePin,onEmbed:this.handleEmbed},"action-bar-"+o.get("id")))),t)))},t}(Y.a),c.contextTypes={router:k.a.object},c.propTypes={params:k.a.object.isRequired,dispatch:k.a.func.isRequired,status:y.a.map,ancestorsIds:y.a.list,descendantsIds:y.a.list,intl:k.a.object.isRequired,askReplyConfirmation:k.a.bool,multiColumn:k.a.bool,domain:k.a.string.isRequired,pictureInPicture:y.a.contains({inUse:k.a.bool,available:k.a.bool})},l=r))||l)||l)}}]);
//# sourceMappingURL=status-174c2d3d0ea604e560f3.chunk.js.map