(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{846:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return X}));var o,a,s,r=n(0),i=n(5),c=n(1),l=n.n(c),d=n(9),u=n(205),p=n(202),h=n(67),v=n(123),f=n(3),m=n(209),g=n(14),b=n(33),M=n(24),j=n.n(M),y=n(2),O=n.n(y),_=n(16),C=n.n(_),k=n(17),w=n(81),R=n(106),I=n(105),x=n(363),L=n(71),S=n(19),T=n(65),D=n(104),U=n(7),A=n(12),H=n.n(A),N=Object(f.f)({more:{id:"status.more",defaultMessage:"More"},open:{id:"conversation.open",defaultMessage:"View Conversation"},reply:{id:"status.reply",defaultMessage:"Reply"},markAsRead:{id:"conversation.mark_as_read",defaultMessage:"Mark As Read"},delete:{id:"conversation.delete",defaultMessage:"Delete Conversation"},muteConversation:{id:"status.mute_conversation",defaultMessage:"Mute Conversation"},unmuteConversation:{id:"status.unmute_conversation",defaultMessage:"Unmute conversation"}}),q=Object(f.g)((s=a=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=e.call.apply(e,[this].concat(o))||this).handleMouseEnter=function(e){var t=e.currentTarget;if(!U.a)for(var n=t.querySelectorAll(".custom-emoji"),o=0;o<n.length;o++){var a=n[o];a.src=a.getAttribute("data-original")}},t.handleMouseLeave=function(e){var t=e.currentTarget;if(!U.a)for(var n=t.querySelectorAll(".custom-emoji"),o=0;o<n.length;o++){var a=n[o];a.src=a.getAttribute("data-static")}},t.handleClick=function(){if(t.context.router){var e=t.props,n=e.lastStatus,o=e.unread,a=e.markRead;o&&a(),t.context.router.history.push("/statuses/"+n.get("id"))}},t.handleMarkAsRead=function(){t.props.markRead()},t.handleReply=function(){t.props.reply(t.props.lastStatus,t.context.router.history)},t.handleDelete=function(){t.props.delete()},t.handleHotkeyMoveUp=function(){t.props.onMoveUp(t.props.conversationId)},t.handleHotkeyMoveDown=function(){t.props.onMoveDown(t.props.conversationId)},t.handleConversationMute=function(){t.props.onMute(t.props.lastStatus)},t.handleShowMore=function(){t.props.onToggleHidden(t.props.lastStatus)},t}return Object(i.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.accounts,n=e.lastStatus,o=e.unread,a=e.scrollKey,s=e.intl;if(null===n)return null;var i=[{text:s.formatMessage(N.open),action:this.handleClick},null];i.push({text:s.formatMessage(n.get("muted")?N.unmuteConversation:N.muteConversation),action:this.handleConversationMute}),o&&(i.push({text:s.formatMessage(N.markAsRead),action:this.handleMarkAsRead}),i.push(null)),i.push({text:s.formatMessage(N.delete),action:this.handleDelete});var c=t.map((function(e){return Object(r.a)(L.a,{to:"/accounts/"+e.get("id"),href:e.get("url"),title:e.get("acct")},e.get("id"),Object(r.a)("bdi",{},void 0,Object(r.a)("strong",{className:"display-name__html",dangerouslySetInnerHTML:{__html:e.get("display_name_html")}})))})).reduce((function(e,t){return[e,", ",t]})),l={reply:this.handleReply,open:this.handleClick,moveUp:this.handleHotkeyMoveUp,moveDown:this.handleHotkeyMoveDown,toggleHidden:this.handleShowMore};return Object(r.a)(D.HotKeys,{handlers:l},void 0,Object(r.a)("div",{className:H()("conversation focusable muted",{"conversation--unread":o}),tabIndex:"0"},void 0,Object(r.a)("div",{className:"conversation__avatar",onClick:this.handleClick,role:"presentation"},void 0,Object(r.a)(x.a,{accounts:t,size:48})),Object(r.a)("div",{className:"conversation__content"},void 0,Object(r.a)("div",{className:"conversation__content__info"},void 0,Object(r.a)("div",{className:"conversation__content__relative-time"},void 0,o&&Object(r.a)("span",{className:"conversation__unread"})," ",Object(r.a)(T.default,{timestamp:n.get("created_at")})),Object(r.a)("div",{className:"conversation__content__names",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},void 0,Object(r.a)(f.b,{id:"conversation.with",defaultMessage:"With {names}",values:{names:Object(r.a)("span",{},void 0,c)}}))),Object(r.a)(w.a,{status:n,onClick:this.handleClick,expanded:!n.get("hidden"),onExpandedToggle:this.handleShowMore,collapsable:!0}),n.get("media_attachments").size>0&&Object(r.a)(R.a,{compact:!0,media:n.get("media_attachments")}),Object(r.a)("div",{className:"status__action-bar"},void 0,Object(r.a)(S.a,{className:"status__action-bar-button",title:s.formatMessage(N.reply),icon:"reply",onClick:this.handleReply}),Object(r.a)("div",{className:"status__action-bar-dropdown"},void 0,Object(r.a)(I.a,{scrollKey:a,status:n,items:i,icon:"ellipsis-h",size:18,direction:"right",title:s.formatMessage(N.more)}))))))},t}(k.a),a.contextTypes={router:O.a.object},a.propTypes={conversationId:O.a.string.isRequired,accounts:C.a.list.isRequired,lastStatus:C.a.map,unread:O.a.bool.isRequired,scrollKey:O.a.string,onMoveUp:O.a.func,onMoveDown:O.a.func,markRead:O.a.func.isRequired,delete:O.a.func.isRequired,intl:O.a.object.isRequired},o=s))||o,K=n(35),E=n(10),P=n(21),z=n(30),V=Object(f.f)({replyConfirm:{id:"confirmations.reply.confirm",defaultMessage:"Reply"},replyMessage:{id:"confirmations.reply.message",defaultMessage:"Replying now will overwrite the message you are currently composing. Are you sure you want to proceed?"}}),W=Object(f.g)(Object(d.connect)((function(){var e=Object(K.g)();return function(t,n){var o=n.conversationId,a=t.getIn(["conversations","items"]).find((function(e){return e.get("id")===o})),s=a.get("last_status",null);return{accounts:a.get("accounts").map((function(e){return t.getIn(["accounts",e],null)})),unread:a.get("unread"),lastStatus:s&&e(t,{id:s})}}}),(function(e,t){var n=t.intl,o=t.conversationId;return{markRead(){e(Object(h.k)(o))},reply(t,o){e((function(a,s){0!==s().getIn(["compose","text"]).trim().length?e(Object(P.d)("CONFIRM",{message:n.formatMessage(V.replyMessage),confirm:n.formatMessage(V.replyConfirm),onConfirm:function(){return e(Object(E.kb)(t,o))}})):e(Object(E.kb)(t,o))}))},delete(){e(Object(h.i)(o))},onMute(t){t.get("muted")?e(Object(z.n)(t.get("id"))):e(Object(z.k)(t.get("id")))},onToggleHidden(t){t.get("hidden")?e(Object(z.l)(t.get("id"))):e(Object(z.j)(t.get("id")))}}}))(q)),J=n(203),F=["conversations","onLoadMore"],Y=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=e.call.apply(e,[this].concat(o))||this).getCurrentIndex=function(e){return t.props.conversations.findIndex((function(t){return t.get("id")===e}))},t.handleMoveUp=function(e){var n=t.getCurrentIndex(e)-1;t._selectChild(n,!0)},t.handleMoveDown=function(e){var n=t.getCurrentIndex(e)+1;t._selectChild(n,!1)},t.setRef=function(e){t.node=e},t.handleLoadOlder=j()((function(){var e=t.props.conversations.last();e&&e.get("last_status")&&t.props.onLoadMore(e.get("last_status"))}),300,{leading:!0}),t}Object(i.a)(t,e);var n=t.prototype;return n._selectChild=function(e,t){var n=this.node.node,o=n.querySelector("article:nth-of-type("+(e+1)+") .focusable");o&&(t&&n.scrollTop>o.offsetTop?o.scrollIntoView(!0):!t&&n.scrollTop+n.clientHeight<o.offsetTop+o.offsetHeight&&o.scrollIntoView(!1),o.focus())},n.render=function(){var e=this,t=this.props,n=t.conversations,o=t.onLoadMore,a=Object(b.a)(t,F);return l.a.createElement(J.a,Object(g.a)({},a,{onLoadMore:o&&this.handleLoadOlder,ref:this.setRef}),n.map((function(t){return Object(r.a)(W,{conversationId:t.get("id"),onMoveUp:e.handleMoveUp,onMoveDown:e.handleMoveDown,scrollKey:e.props.scrollKey},t.get("id"))})))},t}(k.a);Y.propTypes={conversations:C.a.list.isRequired,scrollKey:O.a.string.isRequired,hasMore:O.a.bool,isLoading:O.a.bool,onLoadMore:O.a.func,shouldUpdateScroll:O.a.func};var B,G=Object(d.connect)((function(e){return{conversations:e.getIn(["conversations","items"]),isLoading:e.getIn(["conversations","isLoading"],!0),hasMore:e.getIn(["conversations","hasMore"],!1)}}),(function(e){return{onLoadMore:function(t){return e(Object(h.j)({maxId:t}))}}}))(Y),Q=Object(f.f)({title:{id:"column.direct",defaultMessage:"Direct Messages"}}),X=Object(d.connect)()(B=Object(f.g)(B=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=e.call.apply(e,[this].concat(o))||this).handlePin=function(){var e=t.props,n=e.columnId,o=e.dispatch;o(n?Object(v.h)(n):Object(v.e)("DIRECT",{}))},t.handleMove=function(e){var n=t.props,o=n.columnId;(0,n.dispatch)(Object(v.g)(o,e))},t.handleHeaderClick=function(){t.column.scrollTop()},t.setRef=function(e){t.column=e},t.handleLoadMore=function(e){t.props.dispatch(Object(h.j)({maxId:e}))},t}Object(i.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props.dispatch;e(Object(h.l)()),e(Object(h.j)()),this.disconnect=e(Object(m.b)())},n.componentWillUnmount=function(){this.props.dispatch(Object(h.m)()),this.disconnect&&(this.disconnect(),this.disconnect=null)},n.render=function(){var e=this.props,t=e.intl,n=e.hasUnread,o=e.columnId,a=e.multiColumn,s=e.shouldUpdateScroll,i=!!o;return l.a.createElement(u.a,{bindToDocument:!a,ref:this.setRef,label:t.formatMessage(Q.title)},Object(r.a)(p.a,{icon:"envelope",active:n,title:t.formatMessage(Q.title),onPin:this.handlePin,onMove:this.handleMove,onClick:this.handleHeaderClick,pinned:i,multiColumn:a}),Object(r.a)(G,{trackScroll:!i,scrollKey:"direct_timeline-"+o,timelineId:"direct",onLoadMore:this.handleLoadMore,emptyMessage:Object(r.a)(f.b,{id:"empty_column.direct",defaultMessage:"You don't have any direct messages yet. When you send or receive one, it will show up here."}),shouldUpdateScroll:s}))},t}(l.a.PureComponent))||B)||B}}]);
//# sourceMappingURL=direct_timeline-10dfeaec62a4a5bb4f6f.chunk.js.map