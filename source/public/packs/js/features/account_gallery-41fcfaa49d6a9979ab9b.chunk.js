(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{856:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return C}));var o=t(0),n=t(5),i=t(1),s=t.n(i),c=t(9),l=t(16),r=t.n(l),d=t(2),p=t.n(d),u=t(11),h=t(20),m=t(80),b=t(201),g=t(207),f=t(17),v=t(35),y=t(91),O=t(12),j=t.n(O),I=t(13),_=t(7),M=t(41),L=function(e){function a(){for(var a,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return(a=e.call.apply(e,[this].concat(o))||this).state={visible:"hide_all"!==_.g&&!a.props.attachment.getIn(["status","sensitive"])||"show_all"===_.g,loaded:!1},a.handleImageLoad=function(){a.setState({loaded:!0})},a.handleMouseEnter=function(e){a.hoverToPlay()&&e.target.play()},a.handleMouseLeave=function(e){a.hoverToPlay()&&(e.target.pause(),e.target.currentTime=0)},a.handleClick=function(e){0!==e.button||e.ctrlKey||e.metaKey||(e.preventDefault(),a.state.visible?a.props.onOpenMedia(a.props.attachment):a.setState({visible:!0}))},a}Object(n.a)(a,e);var t=a.prototype;return t.hoverToPlay=function(){return!_.a&&-1!==["gifv","video"].indexOf(this.props.attachment.get("type"))},t.render=function(){var e,a,t,n,i=this.props,s=i.attachment,c=i.displayWidth,l=this.state,r=l.visible,d=l.loaded,p=Math.floor((c-4)/3)-4+"px",u=p,h=s.get("status"),m=h.get("spoiler_text")||s.get("description");if(r){if(["audio","video"].includes(s.get("type")))n=Object(o.a)("img",{src:s.get("preview_url")||s.getIn(["account","avatar_static"]),alt:s.get("description"),onLoad:this.handleImageLoad}),a="audio"===s.get("type")?Object(o.a)(I.a,{id:"music"}):Object(o.a)(I.a,{id:"play"});else if("image"===s.get("type")){var b=100*((s.getIn(["meta","focus","x"])||0)/2+.5),g=100*((s.getIn(["meta","focus","y"])||0)/-2+.5);n=Object(o.a)("img",{src:s.get("preview_url"),alt:s.get("description"),style:{objectPosition:b+"% "+g+"%"},onLoad:this.handleImageLoad})}else"gifv"===s.get("type")&&(n=Object(o.a)("video",{className:"media-gallery__item-gifv-thumbnail","aria-label":s.get("description"),role:"application",src:s.get("url"),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,autoPlay:!Object(M.a)()&&_.a,loop:!0,muted:!0}),a="GIF");e=Object(o.a)("div",{className:"media-gallery__gifv"},void 0,n,a&&Object(o.a)("span",{className:"media-gallery__gifv__label"},void 0,a))}else t=Object(o.a)("span",{className:"account-gallery__item__icons"},void 0,Object(o.a)(I.a,{id:"eye-slash"}));return Object(o.a)("div",{className:"account-gallery__item",style:{width:p,height:u}},void 0,Object(o.a)("a",{className:"media-gallery__item-thumbnail",href:h.get("url"),onClick:this.handleClick,title:m,target:"_blank",rel:"noopener noreferrer"},void 0,Object(o.a)(y.a,{hash:s.get("blurhash"),className:j()("media-gallery__preview",{"media-gallery__preview--hidden":r&&d}),dummy:!_.t}),r?e:t))},a}(f.a);L.propTypes={attachment:r.a.map.isRequired,displayWidth:p.a.number.isRequired,onOpenMedia:p.a.func.isRequired};var w,k,S,x=t(812),N=t(135),T=t(107),q=t(808),R=t(21),A=t(3),P=function(e){function a(){for(var a,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return(a=e.call.apply(e,[this].concat(o))||this).handleLoadMore=function(){a.props.onLoadMore(a.props.maxId)},a}return Object(n.a)(a,e),a.prototype.render=function(){return Object(o.a)(T.a,{disabled:this.props.disabled,onClick:this.handleLoadMore})},a}(f.a);P.propTypes={shouldUpdateScroll:p.a.func,maxId:p.a.string,onLoadMore:p.a.func.isRequired};var C=Object(c.connect)((function(e,a){return{isAccount:!!e.getIn(["accounts",a.params.accountId]),attachments:Object(v.a)(e,a.params.accountId),isLoading:e.getIn(["timelines","account:"+a.params.accountId+":media","isLoading"]),hasMore:e.getIn(["timelines","account:"+a.params.accountId+":media","hasMore"]),suspended:e.getIn(["accounts",a.params.accountId,"suspended"],!1),blockedBy:e.getIn(["relationships",a.params.accountId,"blocked_by"],!1)}}))((S=k=function(e){function a(){for(var a,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return(a=e.call.apply(e,[this].concat(o))||this).state={width:323},a.handleScrollToBottom=function(){a.props.hasMore&&a.handleLoadMore(a.props.attachments.size>0?a.props.attachments.last().getIn(["status","id"]):void 0)},a.handleScroll=function(e){var t=e.target,o=t.scrollTop;150>t.scrollHeight-o-t.clientHeight&&!a.props.isLoading&&a.handleScrollToBottom()},a.handleLoadMore=function(e){a.props.dispatch(Object(h.q)(a.props.params.accountId,{maxId:e}))},a.handleLoadOlder=function(e){e.preventDefault(),a.handleScrollToBottom()},a.handleOpenMedia=function(e){var t=a.props.dispatch,o=e.getIn(["status","id"]);if("video"===e.get("type"))t(Object(R.d)("VIDEO",{media:e,statusId:o,options:{autoPlay:!0}}));else if("audio"===e.get("type"))t(Object(R.d)("AUDIO",{media:e,statusId:o,options:{autoPlay:!0}}));else{var n=e.getIn(["status","media_attachments"]),i=n.findIndex((function(a){return a.get("id")===e.get("id")}));t(Object(R.d)("MEDIA",{media:n,index:i,statusId:o}))}},a.handleRef=function(e){e&&a.setState({width:e.offsetWidth})},a}Object(n.a)(a,e);var t=a.prototype;return t.componentDidMount=function(){this.props.dispatch(Object(u.M)(this.props.params.accountId)),this.props.dispatch(Object(h.q)(this.props.params.accountId))},t.componentWillReceiveProps=function(e){e.params.accountId!==this.props.params.accountId&&e.params.accountId&&(this.props.dispatch(Object(u.M)(e.params.accountId)),this.props.dispatch(Object(h.q)(this.props.params.accountId)))},t.render=function(){var e=this,a=this.props,t=a.attachments,n=a.shouldUpdateScroll,i=a.isLoading,c=a.hasMore,l=a.isAccount,r=a.multiColumn,d=a.blockedBy,p=a.suspended,u=this.state.width;if(!l)return Object(o.a)(b.a,{},void 0,Object(o.a)(q.a,{}));if(!t&&i)return Object(o.a)(b.a,{},void 0,Object(o.a)(m.a,{}));var h,f=null;return!c||i&&0===t.size||(f=Object(o.a)(T.a,{visible:!i,onClick:this.handleLoadOlder})),p?h=Object(o.a)(A.b,{id:"empty_column.account_suspended",defaultMessage:"Account suspended"}):d&&(h=Object(o.a)(A.b,{id:"empty_column.account_unavailable",defaultMessage:"Profile unavailable"})),Object(o.a)(b.a,{},void 0,Object(o.a)(g.a,{multiColumn:r}),Object(o.a)(N.a,{scrollKey:"account_gallery",shouldUpdateScroll:n},void 0,Object(o.a)("div",{className:"scrollable scrollable--flex",onScroll:this.handleScroll},void 0,Object(o.a)(x.a,{accountId:this.props.params.accountId}),p||d?Object(o.a)("div",{className:"empty-column-indicator"},void 0,h):s.a.createElement("div",{role:"feed",className:"account-gallery__container",ref:this.handleRef},t.map((function(a,n){return null===a?Object(o.a)(P,{maxId:n>0?t.getIn(n-1,"id"):null,onLoadMore:e.handleLoadMore},"more:"+t.getIn(n+1,"id")):Object(o.a)(L,{attachment:a,displayWidth:u,onOpenMedia:e.handleOpenMedia},a.get("id"))})),f),i&&0===t.size&&Object(o.a)("div",{className:"scrollable__append"},void 0,Object(o.a)(m.a,{})))))},a}(f.a),k.propTypes={params:p.a.object.isRequired,dispatch:p.a.func.isRequired,attachments:r.a.list.isRequired,isLoading:p.a.bool,hasMore:p.a.bool,isAccount:p.a.bool,blockedBy:p.a.bool,suspended:p.a.bool,multiColumn:p.a.bool},w=S))||w}}]);
//# sourceMappingURL=account_gallery-41fcfaa49d6a9979ab9b.chunk.js.map